# Setup

## Docker Compose

---

- Install [Docker](https://www.docker.com/community-edition) and
 [Docker Compose](https://docs.docker.com/compose/install/)
- Create a directory for your compose file. For example, `home-panel`
- Create a `config.json` using the [template][template]
- Create a `docker-compose.yml` file:

### SSL

!!! info ""
    This example maps the `ssl` directory in the home directory.
    Inside this directory are two files `fullchain.pem` and `privkey.pem`
    which are files generated by [Let's Encrypt](https://letsencrypt.org/).
    Change the environment variables to your own Home Assistant details

```yaml
---
version: '3'

services:
  home-panel:
    image: timmo001/home-panel
    environment:
      REACT_APP_API_URL: https://localhost:3234
    ports:
      - 8234:443
    volumes:
      - ~/ssl:/ssl
  home-panel-api:
    image: timmo001/home-panel-api
    environment:
      CERTIFICATES_DIR: /ssl
    ports:
      - 3234:3234
    volumes:
      - ~/ssl:/ssl
      - PATH_TO_CONFIG/config.json:/usr/src/app/config.json
```

### Non-SSL

!!! warning ""
    This example shows how to set up the app without ssl. This is useful for
     testing, but is **unsecure**, so don't expose the app to the outside
     world.

```yaml
---
version: '3'

services:
  home-panel:
    image: timmo001/home-panel
    environment:
      REACT_APP_API_URL: https://localhost:3123
    ports:
      - 8234:80
    volumes:
      - PATH_TO_CONFIG/config.json:/usr/src/app/config.json
  home-panel-api:
    image: timmo001/home-panel-api
    ports:
      - 3123:3123
    volumes:
      - PATH_TO_CONFIG/config.json:/usr/src/app/config.json
```

## Docker

---

- Install [Docker](https://www.docker.com/community-edition)
- Create a `config.json` using the [template][template]
- Run image

### SSL

!!! info ""
    This example maps the `ssl` directory in the home directory.
    Inside this directory are two files `fullchain.pem` and `privkey.pem`
    which are files generated by [Let's Encrypt](https://letsencrypt.org/).
    Change the environment variables to your own Home Assistant details

```bash
docker run -d \
  -e REACT_APP_API_URL='https://localhost:3234' \
  -p 8234:443 \
  -v ~/ssl:/ssl \
  timmo001/home-panel
```

```bash
docker run -d \
  -e CERTIFICATES_DIR='/ssl' \
  -p 3234:3234 \
  -v ~/ssl:/ssl \
  -v PATH_TO_CONFIG/config.json:/usr/src/app/config.json \
  timmo001/home-panel-api
```

### Non-SSL

!!! warning ""
    This example shows how to set up the app without ssl. This is useful for
     testing, but is **unsecure**, so don't expose the app to the outside
     world.

```bash
docker run -d \
  -e REACT_APP_API_URL='https://localhost:3123' \
  -p 8234:80 \
  timmo001/home-panel
```

```bash
docker run -d \
  -p 3123:3123 \
  -v PATH_TO_CONFIG/config.json:/usr/src/app/config.json \
  timmo001/home-panel-api
```

## Node JS

---

### API Setup

- First clone the
  [Home Assistant API](https://github.com/timmo001/home-panel-api) repository
- Checkout the version you want via releases
- Copy `.env` to `.env.local` and update it to use your own Home Assistant details
- Copy `files/config.template.json` to `files/config.json`
- Update `files/config.json` to your configuration
- Install packages

```bash
yarn install
```

- Run

```bash
node index.js
```

### Webapp

- Clone this repository
- Checkout the version you want via releases
- Install packages

```bash
yarn install
```

#### Production - SSL

- Build a production version

```bash
yarn build
```

- Install nginx
- Edit your server config `/etc/nginx/conf.d/default.conf`

```conf
server {
  listen 443 ssl http2 default_server;
  listen [::]:443 ssl http2 default_server;

  root /usr/share/nginx/html;
  index index.html;
  server_name 172.0.0.1;

  ssl_certificate /ssl/fullchain.pem;
  ssl_certificate_key /ssl/privkey.pem;

  location / {
    try_files $uri /index.html;
  }
}
```

- Copy the files in the build folder into nginx's html directory at
 `/usr/share/nginx/html`
- Start your server

```bash
nginx -g "daemon off;"
```

#### Production - Non-SSL

!!! warning ""
    **This option is not secure. Do not open to the outside world!**

- Build a production version

```bash
yarn build
```

- Install nginx
- Edit your server config `/etc/nginx/conf.d/default.conf`

```conf
server {
  listen 80 default_server;
  listen [::]:80 default_server;
  root /usr/share/nginx/html;
  index index.html;
  server_name 172.0.0.1;
  location / {
    try_files \$uri /index.html;
  }
}
```

- Copy the files in the build folder into nginx's html directory at
 `/usr/share/nginx/html`
- Start your server

```bash
nginx -g "daemon off;"
```

#### Development

!!! warning ""
    **This option is not secure. Do not open to the outside world!**

- Run the app

```bash
yarn start
```

- The app should open in your default browser under [http://localhost:3000](http://localhost:3000)

[template]: https://git.timmo.xyz/home-panel/template/